(function(n){function ut(t,i){var f="",u,s=null,e,l,o,c,a,v,y=i.Obj.data("SPCascadeDropdownsChildColumns");n(y).each(function(){var t=this.opt,y=this.childSelect,k=this.childColumnStatic,w=this.childColumnRequired,b,d,p,g;if(u=pt(i,t.matchOnId),b=u.join(";#"),i.Obj.data("SPCascadeDropdown_Selected_"+k)!==b){if(i.Obj.data("SPCascadeDropdown_Selected_"+k,b),s=pt(y,!0),y.Type==="M"&&(l=y.Obj.closest("span").find("input[name$='MultiLookupPicker$data']"),e=window[y.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")],currentSelection=y.Obj.closest("span").find("select[ID$='SelectResult']")),d=t.relationshipListSortColumn.length>0?t.relationshipListSortColumn:t.relationshipListChildColumn,p="<Query><OrderBy><FieldRef Name='"+d+"'/><\/OrderBy><Where><And>",t.CAMLQuery.length>0&&(p+="<And>"),u.length===0)p+="<Eq><FieldRef Name='"+t.relationshipListParentColumn+"'/><Value Type='Text'><\/Value><\/Eq>";else if(u.length===1)p+="<Eq><FieldRef Name='"+t.relationshipListParentColumn+(t.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+ht(u[0])+"<\/Value><\/Eq>";else{for(g=u.length>2?!0:!1,r=0;r<u.length-1;r++)p+="<Or>";for(r=0;r<u.length;r++)p+="<Eq><FieldRef Name='"+t.relationshipListParentColumn+(t.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+ht(u[r])+"<\/Value><\/Eq>",r>0&&r<u.length-1&&g&&(p+="<\/Or>");p+="<\/Or>"}t.CAMLQuery.length>0&&(p+=t.CAMLQuery+"<\/And>"),p+="<IsNotNull><FieldRef Name='"+t.relationshipListChildColumn+"' /><\/IsNotNull>",p+="<\/And><\/Where><\/Query>",n().SPServices({operation:"GetListItems",async:!1,webURL:t.relationshipWebURL,listName:t.relationshipList,CAMLQuery:p,CAMLViewFields:"<ViewFields><FieldRef Name='"+t.relationshipListParentColumn+"' /><FieldRef Name='"+t.relationshipListChildColumn+"' /><\/ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE<\/IncludeMandatoryColumns><\/QueryOptions>",completefunc:function(i){n(i.responseXML).find("errorstring").each(function(){var i="SPServices.SPCascadeDropdowns",r=n(this).text();t.debug&&r==="One or more field types are not installed properly. Go to the list settings page to delete these fields."?h(i,"relationshipListParentColumn: "+t.relationshipListParentColumn+" or relationshipListChildColumn: "+t.relationshipListChildColumn,"Not found in relationshipList "+t.relationshipList):t.debug&&r==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."&&h(i,"relationshipList: "+t.relationshipList,"List not found");return});switch(y.Type){case"S":n(y.Obj).find("option").remove(),!w&&t.promptText.length>0?y.Obj.append("<option value='0'>"+t.promptText.replace(/\{0\}/g,t.childColumn)+"<\/option>"):w||y.Obj.append("<option value='0'>"+t.noneText+"<\/option>");break;case"C":f=w?"":t.noneText+"|0",y.Obj.attr("value","");break;case"M":n(y.Obj).find("option").remove(),o=""}c=parseFloat(n(i.responseXML).SPFilterNode("rs:data").attr("ItemCount")),n(i.responseXML).SPFilterNode("z:row").each(function(){var i,r,u=n(this).attr("ows_"+t.relationshipListChildColumn),e,h;u!==undefined&&u.indexOf(";#")>0?(e=u.split(";#"),i=e[0],r=e[1]):(i=n(this).attr("ows_ID"),r=u),isNaN(i)&&(i=n(this).attr("ows_ID")),a=i,v=r;switch(y.Type){case"S":h=n(this).attr("ows_ID")===s[0]?" selected='selected'":"",y.Obj.append("<option"+h+" value='"+i+"'>"+r+"<\/option>");break;case"C":i===s[0]&&y.Obj.attr("value",r),f=f+(f.length>0?"|":"")+r+"|"+i;break;case"M":y.Obj.append("<option value='"+i+"'>"+r+"<\/option>"),o+=i+"|t"+r+"|t |t |t"}});switch(y.Type){case"S":y.Obj.trigger("change"),c===1&&t.selectSingleOption===!0&&n(y.Obj).find("option[value!='0']:first").attr("selected","selected");break;case"C":y.Obj.attr("choices",f),c===1&&t.selectSingleOption===!0&&(n(y.Obj).attr("value",v),n("input[id='"+y.Obj.attr("optHid")+"']").val(a)),y.Obj.val()===""&&n("input[id='"+y.Obj.attr("optHid")+"']").val("");break;case"M":e.data="",l.attr("value",o),n(currentSelection).find("option").each(function(){var i=n(this),t=n(this).html();n(this).attr("selected","selected"),n(y.Obj).find("option").filter(function(){return n(this).text()==t.replace(/&amp;/,"&")}).each(function(){n(this).html()===t&&i.removeAttr("selected")})}),GipRemoveSelectedItems(e),n(y.Obj).find("option").each(function(){var t=n(this);n(currentSelection).find("option").each(function(){n(this).html()===t.html()&&t.remove()})}),GipAddSelectedItems(e),e.data=GipGetGroupData(o),y.Obj.trigger("dblclick")}}}),t.completefunc!==null&&t.completefunc()}})}function dt(t,i,u,f){var o=null,c="SPServices.SPDisplayRelatedInfo",s=new p(t.columnName),e,l;if((o=pt(s,t.matchOnId),s.Type!=="C"||!(t.numChars>0)||!(o[0].length<t.numChars))&&s.Obj.attr("showRelatedSelected")!==o[0]){for(s.Obj.attr("showRelatedSelected",o[0]),n("#"+i).remove(),s.Obj.parent().append("<div id="+i+"><\/div>"),e="<Query><Where>",t.CAMLQuery.length>0&&(e+="<And>"),e+="<Eq><FieldRef Name='"+t.relatedListColumn+(t.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+ht(o[0])+"<\/Value><\/Eq>",t.CAMLQuery.length>0&&(e+=t.CAMLQuery+"<\/And>"),e+="<\/Where><\/Query>",l=" ",r=0;r<t.relatedColumns.length;r++)l+="<FieldRef Name='"+t.relatedColumns[r]+"' />";n().SPServices({operation:"GetListItems",async:!1,webURL:t.relatedWebURL,listName:t.relatedList,CAMLQuery:e,CAMLViewFields:"<ViewFields>"+l+"<\/ViewFields>",CAMLRowLimit:0,completefunc:function(e){n(e.responseXML).find("errorstring").each(function(){var i=n(this).text();t.debug&&i==="One or more field types are not installed properly. Go to the list settings page to delete these fields."?h(c,"relatedListColumn: "+t.relatedListColumn,"Column not found in relatedList "+t.relatedList):t.debug&&i==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."&&h(c,"relatedList: "+t.relatedList,"List not found");return});var o;switch(t.displayFormat){case"table":for(o="<table>",o+="<tr>",r=0;r<t.relatedColumns.length;r++){if(typeof f[r]=="undefined"&&t.debug){h(c,"columnName: "+t.relatedColumns[r],"Column not found in relatedList");return}o+="<th class='"+t.headerCSSClass+"'>"+f[r].attr("DisplayName")+"<\/th>"}o+="<\/tr>",n(e.responseXML).SPFilterNode("z:row").each(function(){for(o+="<tr>",r=0;r<t.relatedColumns.length;r++)o+="<td class='"+t.rowCSSClass+"'>"+ai(u,f[r],n(this).attr("ows_"+t.relatedColumns[r]),t)+"<\/td>";o+="<\/tr>"}),o+="<\/table>";break;case"list":o="<table>",n(e.responseXML).SPFilterNode("z:row").each(function(){for(r=0;r<t.relatedColumns.length;r++){if(typeof f[r]=="undefined"&&t.debug){h(c,"columnName: "+t.relatedColumns[r],"Column not found in relatedList");return}o+="<tr>",o+="<th class='"+t.headerCSSClass+"'>"+f[r].attr("DisplayName")+"<\/th>",o+="<td class='"+t.rowCSSClass+"'>"+ai(u,f[r],n(this).attr("ows_"+t.relatedColumns[r]),t)+"<\/td>",o+="<\/tr>"}}),o+="<\/table>"}n("#"+i).html(o)}}),t.completefunc!==null&&t.completefunc()}}function yt(t,i,r,u,f){var o=0,h=0,e={},s;e.type=[],e.src=[],e.script=[],s=RegExp("<script[\\s\\S]*?/script>","gi"),n.ajax({type:"GET",url:f,dataType:"text",async:!1,success:function(l){for(var p,a,w;scriptMatch=s.exec(l);){var y=gt(scriptMatch,"language"),b=gt(scriptMatch,"type"),v=gt(scriptMatch,"src");v!==null&&v.length>0&&!pi(v)&&(e.type.push(y!==null&&y.length>0?y:b),e.src.push(v),h++)}if(!t.showNoScript&&e.type.length>0||t.showNoScript){if(p=f.substring(0,f.lastIndexOf(c)+1),a="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+i.attr("DefaultViewUrl")+"'><IMG border=0 src='"+i.attr("ImageUrl")+"'width=16 height=16><\/A><\/TD><td class=ms-vb2><a href='"+i.attr("DefaultViewUrl")+"'>"+i.attr("Title")+(i.attr("Hidden")==="True"?"(Hidden)":"")+"<\/td><td class=ms-vb2>"+r+"<\/td><td class=ms-vb2>"+u+"<\/td><td class=ms-vb2><a href='"+f+"'>"+st(f)+"<\/td>",t.showSrc){for(a+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>",o=0;o<e.type.length;o++)w=e.src[o].substr(0,1)!==c?p+e.src[o]:e.src[o],a+="<tr><td class=ms-vb2 width='30%'>"+e.type[o]+"<\/td>",a+="<td class=ms-vb2 width='70%'><a href='"+w+"'>"+st(e.src[o])+"<\/td><\/tr>";a+="<\/table><\/td>"}n("#SPScriptAudit").append(a)}}})}function gt(n,t){var i=RegExp(t+"=(\"([^\"]*)\")|('([^']*)')","gi");return(matches=i.exec(n))?matches[2]:null}function pi(n){for(var i=["WebResource.axd","_layouts"],t=0;t<i.length;t++)if(n.indexOf(i[t])>-1)return!0;return!1}function si(n,t){switch(t){case"DateTime":case"datetime":colValue=di(n);break;case"User":colValue=ci(n);break;case"UserMulti":colValue=gi(n);break;case"Lookup":colValue=li(n);break;case"LookupMulti":colValue=nr(n);break;case"Boolean":colValue=ki(n);break;case"Integer":colValue=hi(n);break;case"Counter":colValue=hi(n);break;case"MultiChoice":colValue=tr(n);break;case"Currency":case"float":colValue=bi(n);break;case"Calc":colValue=ir(n);break;default:colValue=wi(n)}return colValue}function wi(n){return n}function hi(n){return parseInt(n,10)}function bi(n){return parseFloat(n)}function ki(n){return n==="0"?!1:!0}function di(n){return new Date(n.replace(/-/g,"/"))}function ci(n){if(n.length===0)return null;var i=n.split(";#"),t=i[1].split(",#");return t.length==1?{userId:i[0],userName:i[1]}:{userId:i[0],userName:t[0].replace(/(,,)/g,","),loginName:t[1].replace(/(,,)/g,","),email:t[2].replace(/(,,)/g,","),sipAddress:t[3].replace(/(,,)/g,","),title:t[4].replace(/(,,)/g,",")}}function gi(n){var i,t,u;if(n.length===0)return null;for(i=[],t=n.split(";#"),r=0;r<t.length;r=r+2)u=ci(t[r]+";#"+t[r+1]),i.push(u);return i}function li(n){if(n.length===0)return null;var t=n.split(";#");return{lookupId:t[0],lookupValue:t[1]}}function nr(n){var i,t,u;if(n.length===0)return null;for(i=[],t=n.split(";#"),r=0;r<t.length;r=r+2)u=li(t[r]+";#"+t[r+1]),i.push(u);return i}function tr(n){if(n.length===0)return null;var i=[],t=n.split(";#");for(r=0;r<t.length;r++)t[r].length!==0&&i.push(t[r]);return i}function ir(n){if(n.length===0)return null;var t=n.split(";#");return si(t[1],t[0])}function ai(t,i,r,u){var l,v,a;if(typeof r=="undefined")return"";var e,f="",o,s,h=[],y=u.relatedWebURL.length>0?u.relatedWebURL:n().SPServices.SPGetCurrentSite();switch(i.attr("Type")){case"Text":f=r;break;case"URL":switch(i.attr("Format")){case"Hyperlink":f="<a href='"+r.substring(0,r.search(","))+"'>"+r.substring(r.search(",")+1)+"<\/a>";break;case"Image":f="<img alt='"+r.substring(r.search(",")+1)+"' src='"+r.substring(0,r.search(","))+"'/>";break;default:f=r}break;case"User":case"UserMulti":for(l=r.split(";#"),e=0;e<l.length;e=e+2)h.push("<a href='/_layouts/userdisp.aspx?ID="+l[e]+"&Source="+ct(location.href)+"'>"+l[e+1]+"<\/a>");f=h.join(", ");break;case"Calculated":v=r.split(";#"),f=v[1];break;case"Number":s=i.attr("Decimals"),f=s===undefined?parseFloat(r).toString():parseFloat(r).toFixed(s).toString();break;case"Currency":s=i.attr("Decimals"),f=s===undefined?parseFloat(r).toFixed(2).toString():parseFloat(r).toFixed(s).toString();break;case"Lookup":switch(i.attr("Name")){case"FileRef":o=t.attr("BaseType")==="1"?t.attr("RootFolder")+c+"Forms/DispForm.aspx":t.attr("RootFolder")+c+"DispForm.aspx",f="<a href='"+o+"?ID="+r.substring(0,r.search(";#"))+"&RootFolder=*&Source="+ct(location.href)+"'>"+r.substring(r.search(";#")+2)+"<\/a>";break;case"FileDirRef":o=c+r.substring(r.search(";#")+2),f="<a href='"+o+"'>"+r.substring(r.search(";#")+2)+"<\/a>";break;default:o=ni(i.attr("List"),"DisplayForm"),f="<a href='"+u.relatedWebURL+c+o+"?ID="+r.substring(0,r.search(";#"))+"&RootFolder=*&Source="+ct(location.href)+"'>"+r.substring(r.search(";#")+2)+"<\/a>"}break;case"LookupMulti":if(o=ni(i.attr("List"),"DisplayForm"),f="",r.length>0)for(a=r.split(";#"),e=0;e<a.length/2;e++)h.push("<a href='"+y+c+o+"?ID="+a[e*2]+"&RootFolder=*&Source="+ct(location.href)+"'>"+a[e*2+1]+"<\/a>");f=h.join(", ");break;case"File":st=r.substring(r.search(";#")+2),f="<a href='"+t.attr("RootFolder")+c+st+"'>"+st+"<\/a>";break;case"Counter":f=r;break;case"DateTime":f=r;break;default:f=r}return f}function vi(n){for(var i="<table class='ms-vb' width='100%'>",t=0;t<n.attributes.length;t++)i+="<tr><td width='10px' style='font-weight:bold;'>"+t+"<\/td><td width='100px'>"+n.attributes.item(t).nodeName+"<\/td><td>"+ti(n.attributes.item(t).nodeValue)+"<\/td><\/tr>";return i+"<\/table>"}function p(t){this.Type=(this.Obj=n("select[Title='"+t+"']")).length===1?"S":(this.Obj=n("input[Title='"+t+"']")).length===1?"C":(this.Obj=n("select[ID$='SelectCandidate'][Title^='"+t+" ']")).length===1?"M":(this.Obj=n("select[ID$='SelectCandidate'][Title$=': "+t+"']")).length===1?"M":(this.Obj=n("select[ID$='SelectCandidate'][Title$='\""+t+"\".']")).length===1?"M":(this.Obj=n("select[ID$='SelectCandidate'][Title$=' "+t+"']")).length===1?"M":null}function pt(t,i){var r=[],u;switch(t.Type){case"S":i?r.push(t.Obj.find("option:selected").val()||[]):r.push(t.Obj.find("option:selected").text()||[]);break;case"C":i?r.push(n("input[id='"+t.Obj.attr("optHid")+"']").val()||[]):r.push(t.Obj.attr("value")||[]);break;case"M":u=t.Obj.closest("span").find("select[ID$='SelectResult']"),n(u).find("option").each(function(){r.push(n(this).html())})}return r}function h(n,t,i){var r="<b>Error in function<\/b><br/>"+n+"<br/><b>Parameter<\/b><br/>"+t+"<br/><b>Message<\/b><br/>"+i+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue<\/span><\/div>";rr(r)}function rr(t){n("#aspnetForm").parent().append("<div id='SPServices_msgBox' style=position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;>"+t);var i=n("#SPServices_msgBox").height(),r=n("#SPServices_msgBox").width(),u=n(window).width()/2-r/2+"px",f=n(window).height()/2-i/2-100+"px";n("#SPServices_msgBox").css({border:"5px #C02000 solid",left:u,top:f}).show().fadeTo("slow",.75).click(function(){n(this).fadeOut("3000",function(){n(this).remove()})})}function et(t,i){return t+"_"+n().SPServices.SPGetStaticFromDisplay({listName:n().SPServices.SPListNameFromUrl(),columnDisplayName:i})}function ni(t,i){var r;return n().SPServices({operation:"GetFormCollection",async:!1,listName:t,completefunc:function(t){r=n(t.responseXML).find("Form[Type='"+i+"']").attr("Url")}}),r}function i(n,t){for(var i=0;i<t.length;i++)typeof t[i]=="string"?u.payload+=y(t[i],n[t[i]]):t[i].length===2?u.payload+=y(t[i][0],n[t[i][1]]):h(n.operation,"paramArray["+i+"]: "+t[i],"Invalid paramArray element passed to addToPayload()")}function ur(t){var i,r=RegExp('FieldName="'+t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return n("td.ms-formbody, td.ms-formbodysurvey").each(function(){if(r.test(n(this).html()))return i=n(this),!1}),i}function ot(n,t){var i=t.substring(8);return n.opheader=n.opheader.replace(t,i),n.opfooter=n.opfooter.replace(t,i),n}function y(n,t){var i=t!==undefined?t:"";return"<"+n+">"+i+"<\/"+n+">"}function fr(){return Math.round(Math.random())-.5}function ti(n){return n.indexOf("http")===0||n.indexOf(c)===0?"<a href='"+n+"'>"+n+"<\/a>":n}function st(n){return n.substring(n.lastIndexOf(c)+1,n.length)}function wt(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ht(n){return typeof n=="string"?n.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):n}function ct(n){return n.replace(/&/g,"%26")}var yi="0.7.2",c="/",b="Column not found on page",a="http://schemas.microsoft.com/sharepoint",bt="Alerts",ii="Authentication",kt="Copy",ri="Forms",s="Lists",ft="Meetings",ui="People",k="Permissions",fi="PublishedLinksService",w="Search",ei="SharePointDiagnostics",d="SiteData",lt="Sites",e="SocialDataService",oi="SpellCheck",g="TaxonomyClientService",f="usergroup",o="UserProfileService",at="Versions",nt="Views",tt="WebPartPages",v="Webs",it="Workflow",vt="",rt="",r=0,t=[],u,l;t.GetAlerts=[bt,!1],t.DeleteAlerts=[bt,!0],t.Mode=[ii,!1],t.Login=[ii,!1],t.CopyIntoItems=[kt,!0],t.CopyIntoItemsLocal=[kt,!0],t.GetItem=[kt,!1],t.GetForm=[ri,!1],t.GetFormCollection=[ri,!1],t.AddAttachment=[s,!0],t.AddDiscussionBoardItem=[s,!0],t.AddList=[s,!0],t.AddListFromFeature=[s,!0],t.ApplyContentTypeToList=[s,!0],t.CheckInFile=[s,!0],t.CheckOutFile=[s,!0],t.CreateContentType=[s,!0],t.DeleteAttachment=[s,!0],t.DeleteContentType=[s,!0],t.DeleteContentTypeXmlDocument=[s,!0],t.DeleteList=[s,!0],t.GetAttachmentCollection=[s,!1],t.GetList=[s,!1],t.GetListAndView=[s,!1],t.GetListCollection=[s,!1],t.GetListContentType=[s,!1],t.GetListContentTypes=[s,!1],t.GetListItemChanges=[s,!1],t.GetListItemChangesSinceToken=[s,!1],t.GetListItems=[s,!1],t.GetVersionCollection=[s,!1],t.UndoCheckOut=[s,!0],t.UpdateContentType=[s,!0],t.UpdateContentTypesXmlDocument=[s,!0],t.UpdateContentTypeXmlDocument=[s,!0],t.UpdateList=[s,!0],t.UpdateListItems=[s,!0],t.AddMeeting=[ft,!0],t.CreateWorkspace=[ft,!0],t.RemoveMeeting=[ft,!0],t.SetWorkSpaceTitle=[ft,!0],t.ResolvePrincipals=[ui,!1],t.SearchPrincipals=[ui,!1],t.AddPermission=[k,!0],t.AddPermissionCollection=[k,!0],t.GetPermissionCollection=[k,!0],t.RemovePermission=[k,!0],t.RemovePermissionCollection=[k,!0],t.UpdatePermission=[k,!0],t.GetLinks=[fi,!0],t.GetPortalSearchInfo=[w,!1],t.GetQuerySuggestions=[w,!1],t.GetSearchMetadata=[w,!1],t.Query=[w,!1],t.QueryEx=[w,!1],t.Registration=[w,!1],t.Status=[w,!1],t.SendClientScriptErrorReport=[ei,!0],t.GetAttachments=[d,!1],t.EnumerateFolder=[d,!1],t.SiteDataGetList=[d,!1],t.SiteDataGetListCollection=[d,!1],t.SiteDataGetSite=[d,!1],t.SiteDataGetSiteUrl=[d,!1],t.SiteDataGetWeb=[d,!1],t.CreateWeb=[lt,!0],t.DeleteWeb=[lt,!1],t.GetSite=[lt,!1],t.GetSiteTemplates=[lt,!1],t.AddComment=[e,!0],t.AddTag=[e,!0],t.AddTagByKeyword=[e,!0],t.CountCommentsOfUser=[e,!1],t.CountCommentsOfUserOnUrl=[e,!1],t.CountCommentsOnUrl=[e,!1],t.CountRatingsOnUrl=[e,!1],t.CountTagsOfUser=[e,!1],t.DeleteComment=[e,!0],t.DeleteRating=[e,!0],t.DeleteTag=[e,!0],t.DeleteTagByKeyword=[e,!0],t.DeleteTags=[e,!0],t.GetAllTagTerms=[e,!1],t.GetAllTagTermsForUrlFolder=[e,!1],t.GetAllTagUrls=[e,!1],t.GetAllTagUrlsByKeyword=[e,!1],t.GetCommentsOfUser=[e,!1],t.GetCommentsOfUserOnUrl=[e,!1],t.GetCommentsOnUrl=[e,!1],t.GetRatingAverageOnUrl=[e,!1],t.GetRatingOfUserOnUrl=[e,!1],t.GetRatingOnUrl=[e,!1],t.GetRatingsOfUser=[e,!1],t.GetRatingsOnUrl=[e,!1],t.GetSocialDataForFullReplication=[e,!1],t.GetTags=[e,!0],t.GetTagsOfUser=[e,!0],t.GetTagTerms=[e,!0],t.GetTagTermsOfUser=[e,!0],t.GetTagTermsOnUrl=[e,!0],t.GetTagUrlsOfUser=[e,!0],t.GetTagUrlsOfUserByKeyword=[e,!0],t.GetTagUrls=[e,!0],t.GetTagUrlsByKeyword=[e,!0],t.SetRating=[e,!0],t.UpdateComment=[e,!0],t.SpellCheck=[oi,!1],t.AddTerms=[g,!0],t.GetChildTermsInTerm=[g,!1],t.GetChildTermsInTermSet=[g,!1],t.GetKeywordTermsByGuids=[g,!1],t.GetTermsByLabel=[g,!1],t.GetTermSets=[g,!1],t.AddGroup=[f,!0],t.AddGroupToRole=[f,!0],t.AddRole=[f,!0],t.AddRoleDef=[f,!0],t.AddUserCollectionToGroup=[f,!0],t.AddUserCollectionToRole=[f,!0],t.AddUserToGroup=[f,!0],t.AddUserToRole=[f,!0],t.GetAllUserCollectionFromWeb=[f,!1],t.GetGroupCollection=[f,!1],t.GetGroupCollectionFromRole=[f,!1],t.GetGroupCollectionFromSite=[f,!1],t.GetGroupCollectionFromUser=[f,!1],t.GetGroupCollectionFromWeb=[f,!1],t.GetGroupInfo=[f,!1],t.GetRoleCollection=[f,!1],t.GetRoleCollectionFromGroup=[f,!1],t.GetRoleCollectionFromUser=[f,!1],t.GetRoleCollectionFromWeb=[f,!1],t.GetRoleInfo=[f,!1],t.GetRolesAndPermissionsForCurrentUser=[f,!1],t.GetRolesAndPermissionsForSite=[f,!1],t.GetUserCollection=[f,!1],t.GetUserCollectionFromGroup=[f,!1],t.GetUserCollectionFromRole=[f,!1],t.GetUserCollectionFromSite=[f,!1],t.GetUserCollectionFromWeb=[f,!1],t.GetUserInfo=[f,!1],t.GetUserLoginFromEmail=[f,!1],t.RemoveGroup=[f,!0],t.RemoveGroupFromRole=[f,!0],t.RemoveRole=[f,!0],t.RemoveUserCollectionFromGroup=[f,!0],t.RemoveUserCollectionFromRole=[f,!0],t.RemoveUserCollectionFromSite=[f,!0],t.RemoveUserFromGroup=[f,!0],t.RemoveUserFromRole=[f,!0],t.RemoveUserFromSite=[f,!0],t.RemoveUserFromWeb=[f,!0],t.UpdateGroupInfo=[f,!0],t.UpdateRoleDefInfo=[f,!0],t.UpdateRoleInfo=[f,!0],t.UpdateUserInfo=[f,!0],t.AddColleague=[o,!0],t.AddLink=[o,!0],t.AddMembership=[o,!0],t.AddPinnedLink=[o,!0],t.CreateMemberGroup=[o,!0],t.CreateUserProfileByAccountName=[o,!0],t.GetCommonColleagues=[o,!1],t.GetCommonManager=[o,!1],t.GetCommonMemberships=[o,!1],t.GetInCommon=[o,!1],t.GetPropertyChoiceList=[o,!1],t.GetUserColleagues=[o,!1],t.GetUserLinks=[o,!1],t.GetUserMemberships=[o,!1],t.GetUserPinnedLinks=[o,!1],t.GetUserProfileByGuid=[o,!1],t.GetUserProfileByIndex=[o,!1],t.GetUserProfileByName=[o,!1],t.GetUserProfileCount=[o,!1],t.GetUserProfileSchema=[o,!1],t.ModifyUserPropertyByAccountName=[o,!0],t.RemoveAllColleagues=[o,!0],t.RemoveAllLinks=[o,!0],t.RemoveAllMemberships=[o,!0],t.RemoveAllPinnedLinks=[o,!0],t.RemoveColleague=[o,!0],t.RemoveLink=[o,!0],t.RemoveMembership=[o,!0],t.RemovePinnedLink=[o,!0],t.UpdateColleaguePrivacy=[o,!0],t.UpdateLink=[o,!0],t.UpdateMembershipPrivacy=[o,!0],t.UpdatePinnedLink=[o,!0],t.DeleteAllVersions=[at,!0],t.DeleteVersion=[at,!0],t.GetVersions=[at,!1],t.RestoreVersion=[at,!0],t.AddView=[nt,!0],t.DeleteView=[nt,!0],t.GetView=[nt,!1],t.GetViewHtml=[nt,!1],t.GetViewCollection=[nt,!1],t.UpdateView=[nt,!0],t.UpdateViewHtml=[nt,!0],t.AddWebPart=[tt,!0],t.AddWebPartToZone=[tt,!0],t.GetWebPart2=[tt,!1],t.GetWebPartPage=[tt,!1],t.GetWebPartProperties=[tt,!1],t.GetWebPartProperties2=[tt,!1],t.CreateContentType=[v,!0],t.GetColumns=[v,!1],t.GetContentType=[v,!1],t.GetContentTypes=[v,!1],t.GetCustomizedPageStatus=[v,!1],t.GetListTemplates=[v,!1],t.GetObjectIdFromUrl=[v,!1],t.GetWeb=[v,!1],t.GetWebCollection=[v,!1],t.GetAllSubWebCollection=[v,!1],t.UpdateColumns=[v,!0],t.UpdateContentType=[v,!0],t.WebUrlFromPageUrl=[v,!1],t.AlterToDo=[it,!0],t.GetTemplatesForItem=[it,!1],t.GetToDosForItem=[it,!1],t.GetWorkflowDataForItem=[it,!1],t.GetWorkflowTaskData=[it,!1],t.StartWorkflow=[it,!0],u={},u.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",u.footer="<\/soap:Body><\/soap:Envelope>",u.payload="",n.fn.SPServices=function(s){var h=n.extend({},n.fn.SPServices.defaults,s),v,b,p,d;u.opheader="<"+h.operation+" ";switch(t[h.operation][0]){case bt:u.opheader+="xmlns='"+a+"/soap/2002/1/alerts/' >",l=a+"/soap/2002/1/alerts/";break;case ft:u.opheader+="xmlns='"+a+"/soap/meetings/' >",l=a+"/soap/meetings/";break;case k:u.opheader+="xmlns='"+a+"/soap/directory/' >",l=a+"/soap/directory/";break;case fi:u.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",l="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case w:u.opheader+="xmlns='urn:Microsoft.Search' >",l="urn:Microsoft.Search/";break;case ei:u.opheader+="xmlns='"+a+"/diagnostics/' >",l="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case e:u.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",l="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case oi:u.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/'",l="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case g:u.opheader+="xmlns='"+a+"/taxonomy/soap/' >",l=a+"/taxonomy/soap/";break;case f:u.opheader+="xmlns='"+a+"/soap/directory/' >",l=a+"/soap/directory/";break;case o:u.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",l="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case tt:u.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",l="http://microsoft.com/sharepoint/webpartpages/";break;case it:u.opheader+="xmlns='"+a+"/soap/workflow/' >",l=a+"/soap/workflow/";break;default:u.opheader+="xmlns='"+a+"/soap/'>",l=a+"/soap/"}l+=h.operation,u.opfooter="<\/"+h.operation+">",v="_vti_bin/"+t[h.operation][0]+".asmx",v=h.webURL.charAt(h.webURL.length-1)===c?h.webURL+v:h.webURL.length>0?h.webURL+c+v:n().SPServices.SPGetCurrentSite()+c+v,u.payload="";switch(h.operation){case"DeleteAlerts":for(u.payload+="<IDs>",r=0;r<h.IDs.length;r++)u.payload+=y("string",h.IDs[r]);u.payload+="<\/IDs>";break;case"Login":i(h,["username","password"]);break;case"CopyIntoItems":for(i(h,["SourceUrl"]),u.payload+="<DestinationUrls>",r=0;r<h.DestinationUrls.length;r++)u.payload+=y("string",h.DestinationUrls[r]);u.payload+="<\/DestinationUrls>",i(h,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(i(h,["SourceUrl"]),u.payload+="<DestinationUrls>",r=0;r<h.DestinationUrls.length;r++)u.payload+=y("string",h.DestinationUrls[r]);u.payload+="<\/DestinationUrls>";break;case"GetItem":i(h,["Url","Fields","Stream"]);break;case"GetForm":i(h,["listName","formUrl"]);break;case"GetFormCollection":i(h,["listName"]);break;case"AddAttachment":i(h,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":i(h,["listName","message"]);break;case"AddList":i(h,["listName","description","templateID"]);break;case"AddListFromFeature":i(h,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":i(h,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":i(h,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":i(h,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":i(h,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":i(h,["listName","listItemID","url"]);break;case"DeleteContentType":i(h,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":i(h,["listName","contentTypeId","documentUri"]);break;case"DeleteList":i(h,["listName"]);break;case"GetAttachmentCollection":i(h,["listName",["listItemID","ID"]]);break;case"GetList":i(h,["listName"]);break;case"GetListAndView":i(h,["listName","viewName"]);break;case"GetListContentType":i(h,["listName","contentTypeId"]);break;case"GetListContentTypes":i(h,["listName"]);break;case"GetListItems":i(h,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":i(h,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":i(h,["listName","viewName","query","viewFields","rowLimit","queryOptions","changeToken","contains"]);break;case"GetVersionCollection":i(h,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":i(h,["pageUrl"]);break;case"UpdateContentType":i(h,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":i(h,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":i(h,["listName","contentTypeId","newDocument"]);break;case"UpdateList":i(h,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(i(h,["listName"]),h.updates!==undefined&&h.updates.length>0)i(h,["updates"]);else{for(u.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+h.batchCmd+"'>",r=0;r<h.valuepairs.length;r++)u.payload+="<Field Name='"+h.valuepairs[r][0]+"'>"+ht(h.valuepairs[r][1])+"<\/Field>";h.batchCmd!=="New"&&(u.payload+="<Field Name='ID'>"+h.ID+"<\/Field>"),u.payload+="<\/Method><\/Batch><\/updates>"}break;case"AddMeeting":i(h,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":i(h,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":i(h,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":i(h,["title"]);break;case"ResolvePrincipals":i(h,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":i(h,["searchText","maxResults","principalType"]);break;case"AddPermission":i(h,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":i(h,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":i(h,["objectName","objectType"]);break;case"RemovePermission":i(h,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":i(h,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":i(h,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetPortalSearchInfo":u.opheader="<"+h.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",l="http://microsoft.com/webservices/OfficeServer/QueryService/"+h.operation;break;case"GetQuerySuggestions":u.opheader="<"+h.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",l="http://microsoft.com/webservices/OfficeServer/QueryService/"+h.operation,u.payload+=y("queryXml",wt(h.queryXml));break;case"GetSearchMetadata":u.opheader="<"+h.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",l="http://microsoft.com/webservices/OfficeServer/QueryService/"+h.operation;break;case"Query":u.payload+=y("queryXml",wt(h.queryXml));break;case"QueryEx":u.opheader="<"+h.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",l="http://microsoft.com/webservices/OfficeServer/QueryService/"+h.operation,u.payload+=y("queryXml",wt(h.queryXml));break;case"Registration":u.payload+=y("registrationXml",wt(h.registrationXml));break;case"SendClientScriptErrorReport":i(h,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":i(h,["strFolderUrl"]);break;case"GetAttachments":i(h,["strListName","strItemId"]);break;case"SiteDataGetList":i(h,["strListName"]),u=ot(u,h.operation);break;case"SiteDataGetListCollection":u=ot(u,h.operation);break;case"SiteDataGetSite":u=ot(u,h.operation);break;case"SiteDataGetSiteUrl":i(h,["Url"]),u=ot(u,h.operation);break;case"SiteDataGetWeb":u=ot(u,h.operation);break;case"CreateWeb":i(h,["urlType","titleType","descriptionType","templateNameType","languageType","languageSpecifiedType","localeType","localeSpecifiedType","collationLocaleType","collationLocaleSpecifiedType","uniquePermissionsType","uniquePermissionsSpecifiedType","anonymousType","anonymousSpecifiedType","presenceType","presenceSpecifiedType"]);break;case"DeleteWeb":i(h,["url"]);break;case"GetSite":i(h,["SiteUrl"]);break;case"GetSiteTemplates":i(h,["LCID","TemplateList"]);break;case"AddComment":i(h,["url","comment","isHighPriority","title"]);break;case"AddTag":i(h,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":i(h,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":i(h,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":i(h,["userAccountName","url"]);break;case"CountCommentsOnUrl":i(h,["url"]);break;case"CountRatingsOnUrl":i(h,["url"]);break;case"CountTagsOfUser":i(h,["userAccountName"]);break;case"DeleteComment":i(h,["url","lastModifiedTime"]);break;case"DeleteRating":i(h,["url"]);break;case"DeleteTag":i(h,["url","termID"]);break;case"DeleteTagByKeyword":i(h,["url","keyword"]);break;case"DeleteTags":i(h,["url"]);break;case"GetAllTagTerms":i(h,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":i(h,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":i(h,["termID"]);break;case"GetAllTagUrlsByKeyword":i(h,["keyword"]);break;case"GetCommentsOfUser":i(h,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":i(h,["userAccountName","url"]);break;case"GetCommentsOnUrl":i(h,["url","maximumItemsToReturn","startIndex"]),h.excludeItemsTime!==undefined&&h.excludeItemsTime.length>0&&(u.payload+=y("excludeItemsTime",h.excludeItemsTime));break;case"GetRatingAverageOnUrl":i(h,["url"]);break;case"GetRatingOfUserOnUrl":i(h,["userAccountName","url"]);break;case"GetRatingOnUrl":i(h,["url"]);break;case"GetRatingsOfUser":i(h,["userAccountName"]);break;case"GetRatingsOnUrl":i(h,["url"]);break;case"GetSocialDataForFullReplication":i(h,["userAccountName"]);break;case"GetTags":i(h,["url"]);break;case"GetTagsOfUser":i(h,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":i(h,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":i(h,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":i(h,["url","maximumItemsToReturn"]);break;case"GetTagUrls":i(h,["termID"]);break;case"GetTagUrlsByKeyword":i(h,["keyword"]);break;case"GetTagUrlsOfUser":i(h,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":i(h,["keyword","userAccountName"]);break;case"SetRating":i(h,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":i(h,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":i(h,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":i(h,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":i(h,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":i(h,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":i(h,["termIds","lcid"]);break;case"GetTermsByLabel":i(h,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":i(h,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":i(h,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":i(h,["groupName","roleName"]);break;case"AddRole":i(h,["roleName","description","permissionMask"]);break;case"AddRoleDef":i(h,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":i(h,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":i(h,["roleName","usersInfoXml"]);break;case"AddUserToGroup":i(h,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":i(h,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetGroupCollection":i(h,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":i(h,["roleName"]);break;case"GetGroupCollectionFromUser":i(h,["userLoginName"]);break;case"GetGroupInfo":i(h,["groupName"]);break;case"GetRoleCollection":i(h,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":i(h,["groupName"]);break;case"GetRoleCollectionFromUser":i(h,["userLoginName"]);break;case"GetRoleInfo":i(h,["roleName"]);break;case"GetUserCollection":i(h,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":i(h,["groupName"]);break;case"GetUserCollectionFromRole":i(h,["roleName"]);break;case"GetUserInfo":i(h,["userLoginName"]);break;case"GetUserLoginFromEmail":i(h,["emailXml"]);break;case"RemoveGroup":i(h,["groupName"]);break;case"RemoveGroupFromRole":i(h,["roleName","groupName"]);break;case"RemoveRole":i(h,["roleName"]);break;case"RemoveUserCollectionFromGroup":i(h,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":i(h,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":i(h,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":i(h,["groupName","userLoginName"]);break;case"RemoveUserFromRole":i(h,["roleName","userLoginName"]);break;case"RemoveUserFromSite":i(h,["userLoginName"]);break;case"RemoveUserFromWeb":i(h,["userLoginName"]);break;case"UpdateGroupInfo":i(h,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":i(h,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":i(h,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":i(h,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":i(h,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":i(h,["accountName","name","url","group","privacy"]);break;case"AddMembership":i(h,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":i(h,["accountName","name","url"]);break;case"CreateMemberGroup":i(h,["membershipInfo"]);break;case"CreateUserProfileByAccountName":i(h,["accountName"]);break;case"GetCommonColleagues":i(h,["accountName"]);break;case"GetCommonManager":i(h,["accountName"]);break;case"GetCommonMemberships":i(h,["accountName"]);break;case"GetInCommon":i(h,["accountName"]);break;case"GetPropertyChoiceList":i(h,["propertyName"]);break;case"GetUserColleagues":i(h,["accountName"]);break;case"GetUserLinks":i(h,["accountName"]);break;case"GetUserMemberships":i(h,["accountName"]);break;case"GetUserPinnedLinks":i(h,["accountName"]);break;case"GetUserProfileByGuid":i(h,["guid"]);break;case"GetUserProfileByIndex":i(h,["index"]);break;case"GetUserProfileByName":h.accountName!==undefined&&h.accountName.length>0?i(h,[["AccountName","accountName"]]):i(h,["AccountName"]);break;case"ModifyUserPropertyByAccountName":i(h,["accountName","newData"]);break;case"RemoveAllColleagues":i(h,["accountName"]);break;case"RemoveAllLinks":i(h,["accountName"]);break;case"RemoveAllMemberships":i(h,["accountName"]);break;case"RemoveAllPinnedLinks":i(h,["accountName"]);break;case"RemoveColleague":i(h,["accountName","colleagueAccountName"]);break;case"RemoveLink":i(h,["accountName","id"]);break;case"RemoveMembership":i(h,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":i(h,["accountName","id"]);break;case"UpdateColleaguePrivacy":i(h,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":i(h,["accountName","data"]);break;case"UpdateMembershipPrivacy":i(h,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":i(h,["accountName","data"]);break;case"DeleteAllVersions":i(h,["fileName"]);break;case"DeleteVersion":i(h,["fileName","fileVersion"]);break;case"GetVersions":i(h,["fileName"]);break;case"RestoreVersion":i(h,["fileName","fileVersion"]);break;case"AddView":i(h,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":i(h,["listName","viewName"]);break;case"GetView":i(h,["listName","viewName"]);break;case"GetViewCollection":i(h,["listName"]);break;case"GetViewHtml":i(h,["listName","viewName"]);break;case"UpdateView":i(h,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":i(h,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":i(h,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":i(h,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"GetWebPart2":i(h,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":i(h,["documentName","behavior"]);break;case"GetWebPartProperties":i(h,["pageUrl","storage"]);break;case"GetWebPartProperties2":i(h,["pageUrl","storage","behavior"]);break;case"Webs.CreateContentType":i(h,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":i(h,["webUrl"]);break;case"GetContentType":i(h,["contentTypeId"]);break;case"GetCustomizedPageStatus":i(h,["fileUrl"]);break;case"GetObjectIdFromUrl":i(h,["objectUrl"]);break;case"GetWeb":i(h,[["webUrl","webURL"]]);break;case"UpdateColumns":i(h,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":i(h,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":i(h,[["pageUrl","pageURL"]]);break;case"AlterToDo":i(h,["item","todoId","todoListId","taskData"]);break;case"GetTemplatesForItem":i(h,["item"]);break;case"GetToDosForItem":i(h,["item"]);break;case"GetWorkflowDataForItem":i(h,["item"]);break;case"GetWorkflowTaskData":i(h,["item","listId","taskId"]);break;case"StartWorkflow":i(h,["item","templateId","workflowParameters"])}b=u.header+u.opheader+u.payload+u.opfooter+u.footer,d=null,h.cacheXML&&(p=n("body").data(b)),p===undefined?n.ajax({url:v,async:h.async,beforeSend:function(n){t[h.operation][1]&&n.setRequestHeader("SOAPAction",l)},type:"POST",data:b,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(t,i){h.cacheXML&&n("body").data(b,t),p=t,d=i,h.completefunc(p,d)}}):h.completefunc(p,d)},n.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions><\/QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},n.fn.SPServices.SPGetCurrentSite=function(){if(vt.length>0)return vt;var t=u.header+"<WebUrlFromPageUrl xmlns='"+a+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"<\/pageUrl><\/WebUrlFromPageUrl>"+u.footer;return n.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:t,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(t){vt=n(t.responseXML).find("WebUrlFromPageUrlResult").text()}}),vt},n.fn.SPServices.SPCascadeDropdowns=function(t){var i=n.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:n().SPServices.SPListNameFromUrl(),CAMLQuery:"",promptText:"",noneText:"(None)",simpleChild:!1,selectSingleOption:!1,matchOnId:!1,completefunc:null,debug:!1},t),o=!1,s="SPServices.SPCascadeDropdowns",r=new p(i.parentColumn),u,e,f;if(r.Obj.html()===null&&i.debug){h(s,"parentColumn: "+i.parentColumn,b);return}if(u=new p(i.childColumn),u.Obj.html()===null&&i.debug){h(s,"childColumn: "+i.childColumn,b);return}if(i.simpleChild===!0&&u.Type==="C"&&(n().SPServices.SPComplexToSimpleDropdown({columnName:i.childColumn}),u=new p(i.childColumn)),n().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:i.listName,completefunc:function(t){n(t.responseXML).find("Fields").each(function(){n(this).find("Field[DisplayName='"+i.childColumn+"']").each(function(){return childColumnRequired=n(this).attr("Required")==="TRUE"?!0:!1,childColumnStatic=n(this).attr("StaticName"),!1})})}}),e={opt:i,childSelect:u,childColumnStatic:childColumnStatic,childColumnRequired:childColumnRequired},f=r.Obj.data("SPCascadeDropdownsChildColumns"),f===undefined?r.Obj.data("SPCascadeDropdownsChildColumns",[e]):(f.push(e),r.Obj.data("SPCascadeDropdownsChildColumns",f),o=!0),!o)switch(r.Type){case"S":r.Obj.bind("change",function(){ut(i.parentColumn,r)});break;case"C":n("input[id='"+r.Obj.attr("optHid")+"']").bind("propertychange",function(){ut(i.parentColumn,r)});break;case"M":r.Obj.bind("dblclick",function(){ut(i.parentColumn,r)}),parentSelections=r.Obj.closest("span").find("select[id$='SelectResult']"),parentSelections.bind("dblclick",function(){ut(i.parentColumn,r)}),r.Obj.closest("span").find("button").each(function(){n(this).bind("click",function(){ut(i.parentColumn,r)})})}ut(i.parentColumn,r)},n.fn.SPServices.SPComplexToSimpleDropdown=function(t){var u=n.extend({},{columnName:"",completefunc:null,debug:!1},t),i=new p(u.columnName),c;if(i.Obj.html()===null&&u.debug){h("SPServices.SPComplexToSimpleDropdown","columnName: "+u.columnName,b);return}if(i.Type==="C"){var f=n(i.Obj).attr("choices").split("|"),s=n(i.Obj).attr("optHid"),l=n("input[id='"+s+"']"),a=n("input[id='"+s+"']").val(),e=et("SPComplexToSimpleDropdown",u.columnName),o="<select id='"+e+"' title='"+u.columnName+"'>";for(r=0;r<f.length;r=r+2)c=f[r+1]===a?" selected='selected' ":" ",o+="<option"+c+"value='"+f[r+1]+"'>"+f[r]+"<\/option>";o+="<\/select>",n(i.Obj).closest("td").prepend(o),n(i.Obj).closest("span").find("img").remove(),n(i.Obj).closest("span").find("input").hide(),n("#"+e).change(function(){var t=n(this).val();l.val(t),n(i.Obj).val(n(this).find("option[value='"+(t!=="0"?t:"")+"']").html())}),n("#"+e).trigger("change"),u.completefunc!==null&&u.completefunc()}},n.fn.SPServices.SPDisplayRelatedInfo=function(t){var i=n.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:!1,completefunc:null,debug:!1},t),u,f=[],e,s="SPServices.SPDisplayRelatedInfo",o=new p(i.columnName);if(o.Obj.html()===null&&i.debug){h(s,"columnName: "+i.columnName,b);return}u=et("SPDisplayRelatedInfo",i.columnName),n().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:i.relatedWebURL,listName:i.relatedList,completefunc:function(t){for(n(t.responseXML).find("faultcode").each(function(){if(i.debug){h(s,"relatedList: "+i.relatedList,"List not found");return}}),e=n(t.responseXML).find("List"),r=0;r<i.relatedColumns.length;r++)f[r]=n(t.responseXML).find("Fields > Field[Name='"+i.relatedColumns[r]+"']")}});switch(o.Type){case"S":o.Obj.bind("change",function(){dt(i,u,e,f)});break;case"C":n("input[id='"+o.Obj.attr("optHid")+"']").bind("propertychange",function(){dt(i,u,e,f)});break;case"M":i.debug&&h(s,"columnName: "+i.columnName,"Multi-select columns not supported by this function")}dt(i,u,e,f)},n.fn.SPServices.SPFilterDropdown=function(t){var i=n.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",columnName:"",listName:n().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE<\/IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/><\/QueryOptions>",completefunc:null,debug:!1},t),u="",c=null,f,a,e,o,l="SPServices.SPFilterDropdown",r=new p(i.columnName),v,s;if(r.Obj.html()===null&&i.debug){h(l,"columnName: "+i.columnName,b);return}c=pt(r,!0),v=i.relationshipListSortColumn.length>0?i.relationshipListSortColumn:i.relationshipListColumn,s="<Query><OrderBy><FieldRef Name='"+v+"'/><\/OrderBy><Where>",i.CAMLQuery.length>0&&(s+=i.CAMLQuery),s+="<\/Where><\/Query>",n().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:i.listName,completefunc:function(t){n(t.responseXML).find("Fields").each(function(){n(this).find("Field[DisplayName='"+i.columnName+"']").each(function(){return o=n(this).attr("Required")==="TRUE"?!0:!1,!1})})}}),n().SPServices({operation:"GetListItems",async:!1,webURL:i.relationshipWebURL,listName:i.relationshipList,CAMLQuery:s,CAMLViewFields:"<ViewFields><FieldRef Name='"+i.relationshipListColumn+"' /><\/ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:i.CAMLQueryOptions,completefunc:function(t){n(t.responseXML).find("errorstring").each(function(){var t=n(this).text();i.debug&&t==="One or more field types are not installed properly. Go to the list settings page to delete these fields."?h(l,"relationshipListColumn: "+i.relationshipListColumn,"Not found in relationshipList "+i.relationshipList):i.debug&&t==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."&&h(l,"relationshipList: "+i.relationshipList,"List not found");return});switch(r.Type){case"S":n(r.Obj).find("option").remove(),!o&&i.promptText.length>0?r.Obj.append("<option value='0'>"+i.promptText.replace(/\{0\}/g,i.columnName)+"<\/option>"):o||r.Obj.append("<option value='0'>"+i.noneText+"<\/option>");break;case"C":u=o?"":i.noneText+"|0",r.Obj.attr("value","");break;case"M":n(r.Obj).find("option").remove(),e=""}n(t.responseXML).SPFilterNode("z:row").each(function(){var t,f,o=n(this).attr("ows_"+i.relationshipListColumn),s,h;o!==undefined&&o.indexOf(";#")>0?(s=o.split(";#"),t=s[0],f=s[1]):(t=n(this).attr("ows_ID"),f=o),isNaN(t)&&(t=n(this).attr("ows_ID"));switch(r.Type){case"S":h=n(this).attr("ows_ID")===c[0]?" selected='selected'":"",r.Obj.append("<option"+h+" value='"+t+"'>"+f+"<\/option>");break;case"C":t===c[0]&&r.Obj.attr("value",f),u=u+(u.length>0?"|":"")+f+"|"+t;break;case"M":r.Obj.append("<option value='"+t+"'>"+f+"<\/option>"),e+=t+"|t"+f+"|t |t |t"}});switch(r.Type){case"S":r.Obj.trigger("change");break;case"C":r.Obj.attr("choices",u),r.Obj.trigger("propertychange");break;case"M":a=r.Obj.closest("span").find("input[name$='MultiLookupPicker$data']"),f=window[r.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")],currentSelection=r.Obj.closest("span").find("select[ID$='SelectResult']"),f.data="",a.attr("value",e),n(currentSelection).find("option").each(function(){var t=n(this);n(this).attr("selected","selected"),n(r.Obj).find("option").each(function(){n(this).html()===t.html()&&t.removeAttr("selected")})}),GipRemoveSelectedItems(f),n(r.Obj).find("option").each(function(){var t=n(this);n(currentSelection).find("option").each(function(){n(this).html()===t.html()&&t.remove()})}),GipAddSelectedItems(f),f.data=GipGetGroupData(e),r.Obj.trigger("dblclick")}}}),i.completefunc!==null&&i.completefunc()},n.fn.SPServices.SPDebugXMLHttpResult=function(t){var i=n.extend({},{node:null,indent:0},t),u,r="";if(r+="<table class='ms-vb' style='margin-left:"+i.indent*3+"px;' width='100%'>",i.node.nodeName==="DisplayPattern")r+="<tr><td width='100px' style='font-weight:bold;'>"+i.node.nodeName+"<\/td><td><textarea readonly='readonly' rows='5' cols='50'>"+i.node.xml+"<\/textarea><\/td><\/tr>";else if(i.node.hasChildNodes())if(i.node.hasChildNodes()&&i.node.firstChild.nodeType===4)r+="<tr><td width='100px' style='font-weight:bold;'>"+i.node.nodeName+"<\/td><td><textarea readonly='readonly' rows='5' cols='50'>"+i.node.parentNode.text+"<\/textarea><\/td><\/tr>";else if(i.node.hasChildNodes()&&i.node.firstChild.nodeType===3)r+="<tr><td width='100px' style='font-weight:bold;'>"+i.node.nodeName+"<\/td><td>"+ti(i.node.firstChild.nodeValue)+"<\/td><\/tr>";else{for(r+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+i.node.nodeName+"<\/td><\/tr>",i.node.attributes&&(r+="<tr><td colspan='99'>"+vi(i.node,i)+"<\/td><\/tr>"),r+="<tr><td>",u=0;u<i.node.childNodes.length;u++)r+=n().SPServices.SPDebugXMLHttpResult({node:i.node.childNodes.item(u),indent:i.indent+1});r+="<\/td><\/tr>"}else r+="<tr><td width='100px' style='font-weight:bold;'>"+i.node.nodeName+"<\/td><td>"+(i.node.nodeValue!==null?ti(i.node.nodeValue):"&nbsp;")+"<\/td><\/tr>",i.node.attributes&&(r+="<tr><td colspan='99'>"+vi(i.node,i)+"<\/td><\/tr>");return r+"<\/table>"},n.fn.SPServices.SPGetCurrentUser=function(t){var u=n.extend({},{fieldName:"Name",fieldNames:{},debug:!1},t),s;if(u.fieldName==="ID"&&_spUserId!=undefined)return _spUserId;var i="",e={},f=u.fieldNames.length>0?u.fieldNames.length:1,o;for(n.ajax({async:!1,url:n().SPServices.SPGetCurrentSite()+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(n){o=n}}),r=0;r<f;r++)u.fieldNames[r]==="ID"?i=_spUserId:(s=f>1?RegExp('FieldInternalName="'+u.fieldNames[r]+'"',"gi"):RegExp('FieldInternalName="'+u.fieldName+'"',"gi"),n(o.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(s.test(n(this).html())){switch(n(this).attr("id")){case"SPFieldText":i=n(this).text();break;case"SPFieldNote":i=n(this).find("div").html();break;case"SPFieldURL":i=n(this).find("img").attr("src");break;default:i=n(this).text()}return!1}})),u.fieldNames[r]!=="ID"&&(i=i!==undefined?i.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),f>1&&(e[u.fieldNames[r]]=i);return f>1?e:i},n.fn.SPServices.SPLookupAddNew=function(t){var i=n.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:!1,ContentTypeID:"",completefunc:null,debug:!1},t),u="SPServices.SPLookupAddNew",o=new p(i.lookupColumn),e;if(o.Obj.html()===null&&i.debug){h(u,"lookupColumn: "+i.lookupColumn,b);return}var f="",r="",s="";if(n().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:n().SPServices.SPListNameFromUrl(),completefunc:function(t){n(t.responseXML).find("Field[DisplayName='"+i.lookupColumn+"']").each(function(){return s=n(this).attr("StaticName"),n().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:n(this).attr("List"),completefunc:function(t){n(t.responseXML).find("List").each(function(){r=n(this).attr("WebFullUrl"),r=r!==c?r+c:r})}}),f=ni(n(this).attr("List"),"NewForm"),!1})}}),r.length===0&&i.debug){h(u,"lookupColumn: "+i.lookupColumn,"This column does not appear to be a lookup column");return}if(f.length>0)e=r+f,e+=i.newWindow?(i.ContentTypeID.length>0?"?ContentTypeID="+i.ContentTypeID:"")+"' target='_blank'":"?"+(i.ContentTypeID.length>0?"ContentTypeID="+i.ContentTypeID+"&":"")+"Source="+ct(location.href)+"'",newLink="<div id='SPLookupAddNew_"+s+"'><a href='"+e+">"+i.promptText.replace(/\{0\}/g,i.lookupColumn)+"<\/a><\/div>",n(o.Obj).parents("td.ms-formbody").append(newLink);else if(i.debug){h(u,"lookupColumn: "+i.lookupColumn,"NewForm cannot be found");return}i.completefunc!==null&&i.completefunc()},n.fn.SPServices.SPGetLastItemId=function(t){var i=n.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},t),u,f=0,r;return n().SPServices({operation:"GetUserInfo",webURL:i.webURL,async:!1,userLoginName:i.userAccount!==""?i.userAccount:n().SPServices.SPGetCurrentUser(),completefunc:function(t){n(t.responseXML).find("User").each(function(){u=n(this).attr("ID")})}}),r="<Query><Where>",i.CAMLQuery.length>0&&(r+="<And>"),r+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+u+"<\/Value><\/Eq>",i.CAMLQuery.length>0&&(r+=i.CAMLQuery+"<\/And>"),r+="<\/Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/><\/OrderBy><\/Query>",n().SPServices({operation:"GetListItems",async:!1,webURL:i.webURL,listName:i.listName,CAMLQuery:r,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/><\/ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /><\/QueryOptions>",completefunc:function(t){n(t.responseXML).SPFilterNode("z:row").each(function(){f=n(this).attr("ows_ID")})}}),f},n.fn.SPServices.SPRequireUnique=function(t){var i=n.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},t),e=n().SPServices.SPGetQueryString(),o=e.ID,u=n().SPServices.SPListNameFromUrl(),s="<span id='SPRequireUnique"+i.columnStaticName+"' class='{0}'>{1}<\/span><br/>",h=s.replace(/\{0\}/g,i.initMsgCSSClass).replace(/\{1\}/g,i.initMsg),c=n().SPServices.SPGetDisplayFromStatic({listName:u,columnStaticName:i.columnStaticName}),f=n("input[Title='"+c+"']");n(f).parent().append(h),n(f).blur(function(){var t=[],e=n(this).attr("value"),f,s;if(e.length===0)return!1;if(n().SPServices({operation:"GetListItems",async:!1,listName:u,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+i.columnStaticName+"'/><\/IsNotNull><\/Where><\/Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+i.columnStaticName+"' /><\/ViewFields>",CAMLRowLimit:0,completefunc:function(r){var u=i.ignoreCase?e.toUpperCase():e;n(r.responseXML).SPFilterNode("z:row").each(function(){var r=i.ignoreCase?n(this).attr("ows_"+i.columnStaticName).toUpperCase():n(this).attr("ows_"+i.columnStaticName);u===r&&n(this).attr("ows_ID")!==o&&t.push([n(this).attr("ows_ID"),n(this).attr("ows_"+i.columnStaticName)])})}}),f=i.initMsg,n("span#SPRequireUnique"+i.columnStaticName).html(f).attr("class",i.initMsgCSSClass),n("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),t.length>0&&(f=i.errMsg,n("span#SPRequireUnique"+i.columnStaticName).html(f).attr("class",i.errMsgCSSClass),i.duplicateAction===1&&(n("input[Title='"+i.columnDisplayName+"']").focus(),n("input[value='OK'], input[value='Save']").attr("disabled","disabled")),i.showDupes)){for(s=" "+t.length+" duplicate item"+(t.length>1?"s":"")+": ",r=0;r<t.length;r++)s+="<a href='DispForm.aspx?ID="+t[r][0]+"&Source="+location.href+"'>"+t[r][1]+"<\/a> ";n("span#SPRequireUnique"+i.columnStaticName).append(s)}}),i.completefunc!==null&&i.completefunc()},n.fn.SPServices.SPGetDisplayFromStatic=function(t){var i=n.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},t),f="",e={},u=i.columnStaticNames.length>0?i.columnStaticNames.length:1;return n().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:i.webURL,listName:i.listName,completefunc:function(t){if(u>1)for(r=0;r<u;r++)e[i.columnStaticNames[r]]=n(t.responseXML).find("Field[StaticName='"+i.columnStaticNames[r]+"']").attr("DisplayName");else f=n(t.responseXML).find("Field[StaticName='"+i.columnStaticName+"']").attr("DisplayName")}}),u>1?e:f},n.fn.SPServices.SPGetStaticFromDisplay=function(t){var i=n.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},t),f="",e={},u=i.columnDisplayNames.length>0?i.columnDisplayNames.length:1;return n().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:i.webURL,listName:i.listName,completefunc:function(t){if(u>1)for(r=0;r<u;r++)e[i.columnDisplayNames[r]]=n(t.responseXML).find("Field[DisplayName='"+i.columnDisplayNames[r]+"']").attr("StaticName");else f=n(t.responseXML).find("Field[DisplayName='"+i.columnDisplayName+"']").attr("StaticName")}}),u>1?e:f},n.fn.SPServices.SPRedirectWithID=function(t){var u=n.extend({},{redirectUrl:"",qsParamName:"ID"},t),f=n().SPServices.SPListNameFromUrl(),i=n().SPServices.SPGetQueryString(),r=i.ID,e=i.List,o=i.RootFolder,s=i.ContentTypeId,h;if(typeof i.ID=="undefined")r=n().SPServices.SPGetLastItemId({listName:f}),n("form[name='aspnetForm']").each(function(){var u=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,h=typeof i.Source=="string"?"Source="+i.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",t=[],f;typeof e!="undefined"&&t.push("List="+e),typeof o!="undefined"&&t.push("RootFolder="+o),typeof s!="undefined"&&t.push("ContentTypeId="+s),f=u+(t.length>0?"?"+t.join("&")+"&":"?")+"Source="+u+"?ID="+r+(h.length>0?"%26RealSource="+i.Source:"")+(typeof i.RedirectURL=="string"?"%26RedirectURL="+i.RedirectURL:""),n(this).attr("action",f)});else{while(i.ID===r)r=n().SPServices.SPGetLastItemId({listName:f});h=typeof i.RedirectURL=="string"?i.RedirectURL:u.redirectUrl,location.href=h+"?"+u.qsParamName+"="+r+(typeof i.RealSource=="string"?"&Source="+i.RealSource:"")}},n.fn.SPServices.SPSetMultiSelectSizes=function(t){var i=n.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},t),l="SPServices.SPSetMultiSelectSizes",o=new p(i.multiSelectColumn),s,f,r,c;if(o.Obj.html()===null&&i.debug){h(l,"multiSelectColumn: "+i.multiSelectColumn,b);return}if(o.Type!=="M"&&i.debug){h(l,"multiSelectColumn: "+i.multiSelectColumn,"Column is not multi-select.");return}var u=o.Obj,a=u.closest("span").find("select[ID$='SelectResult']"),e=et("SPSetMultiSelectSizes",i.multiSelectColumn);u.clone().appendTo(u.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:e,length:0}),s=n("#"+e),u.find("option").each(function(){s.append("<option value='"+n(this).html()+"'>"+n(this).html()+"<\/option>")}),a.find("option").each(function(){s.append("<option value='"+n(this).html()+"'>"+n(this).html()+"<\/option>")}),f=n("#"+e).width()+5,r=f,(i.minWidth>0||i.maxWidth>0)&&(f<i.minWidth&&(f=i.minWidth),r<i.minWidth&&(r=i.minWidth),r>i.maxWidth&&(r=i.maxWidth)),c=f,u.css("width",c+"px").parent().css("width",r+"px"),a.css("width",c+"px").parent().css("width",r+"px"),n("#"+e).remove()},n.fn.SPServices.SPScriptAudit=function(t){var i=n.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},t),f=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]],u,o,e;if(n("#"+i.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th><\/th><th>List<\/th><th>Page Class<\/th><th>Page Type<\/th><th>Page<\/th>"+(i.showSrc?"<th>Script References<\/th>":"")+"<\/tr><\/table>"),n("#SPScriptAudit th").attr("class","ms-vh2-nofilter"),(i.auditForms||i.auditViews)&&n().SPServices({operation:"GetListCollection",webURL:i.webURL,async:!1,completefunc:function(t){n(t.responseXML).find("List").each(function(){u=n(this),(i.listName.length===0||u.attr("Title")===i.listName)&&(i.showHiddenLists&&u.attr("Hidden")==="False"||!i.showHiddenLists)&&(i.auditForms&&n().SPServices({operation:"GetListContentTypes",webURL:i.webURL,listName:u.attr("ID"),async:!1,completefunc:function(t){n(t.responseXML).find("ContentType").each(function(){var e,t;if(n(this).attr("ID").substring(0,6)!=="0x0120"){for(e=n(this).find("FormUrls"),r=0;r<f.length;r++)n(e).find(f[r][0]).each(function(){yt(i,u,"Form",this.nodeName,(i.webURL.length>0?i.webURL:n().SPServices.SPGetCurrentSite())+c+n(this).text()),f[r][2]=!0}),f[r][2]||(t=u.attr("DefaultViewUrl"),yt(i,u,"Form",f[r][0],t.substring(0,t.lastIndexOf(c)+1)+f[r][1]));for(r=0;r<f.length;r++)f[r][2]=!1}})}}),i.auditViews&&n().SPServices({operation:"GetViewCollection",webURL:i.webURL,listName:u.attr("ID"),async:!1,completefunc:function(t){n(t.responseXML).find("View").each(function(){yt(i,u,"View",n(this).attr("DisplayName"),n(this).attr("Url"))})}}))})}}),o=0,e=[],typeof i.auditPagesListName=="string"?(o=1,e.push(i.auditPagesListName)):(o=i.auditPagesListName.length,e=i.auditPagesListName),i.auditPages)for(r=0;r<o;r++)n().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:i.webURL,listName:e[r],completefunc:function(t){n(t.responseXML).find("List").each(function(){u=n(this)})}}),n().SPServices({operation:"GetListItems",async:!1,webURL:i.webURL,listName:e[r],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder<\/Value><\/Neq><\/Where><\/Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/><\/ViewFields>",CAMLRowLimit:0,completefunc:function(t){n(t.responseXML).SPFilterNode("z:row").each(function(){var t=n(this).attr("ows_FileRef").split(";#")[1],r=typeof n(this).attr("ows_Title")!="undefined"?n(this).attr("ows_Title"):"";t.indexOf(".aspx")>0&&yt(i,u,"Page",r,c+t)})}});n("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class")},n.fn.SPServices.SPArrangeChoices=function(t){var i=n.extend({},{listName:"",columnName:"",perRow:99,randomize:!1},t),f=!1,e=[],u;n().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:i.listName.length>0?i.listName:n().SPServices.SPListNameFromUrl(),completefunc:function(t){n(t.responseXML).find("Fields").each(function(){n(this).find("Field[DisplayName='"+i.columnName+"']").each(function(){return f=n(this).attr("FillInChoice")==="TRUE"?!0:!1,!1})})}});var o=ur(i.columnName),h=n(o).find("tr").length,s=0,c,l;for(n(o).find("tr").each(function(){s++,f&&s===h-1?c=n(this).find("td").html():f&&s===h?l=n(this).find("td").html():e.push(n(this).html())}),u="<TR>",i.randomize&&e.sort(fr),r=0;r<e.length;r++)u+=e[r],(r+1)%i.perRow==0&&(u+="<\/TR><TR>");u+="<\/TR>",f&&(u+="<TR><TD colspan='99'>"+c+l+"<\/TD><\/TR>"),n(o).find("tr").remove(),n(o).find("table").append(u)},n.fn.SPServices.SPAutocomplete=function(t){var i=n.extend({},{WebURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><\/QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},t),e,u=n("input[Title='"+i.columnName+"']"),f;n("input[Title='"+i.columnName+"']").css("position","");var s=u.attr("ID"),c=u.css("color"),o=u.css("width");if(u.html()===null&&i.debug){h("SPServices.SPAutocomplete","columnName: "+i.columnName,"Column is not an input control or is not found on page");return}u.closest("span").find("br").remove(),u.wrap("<div>"),f=et("SPAutocomplete",i.columnName),u.after("<div><ul id='"+f+"' style='width:"+o+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'><\/div>"),n("#"+f).css("width",o),n(u).keyup(function(){var h=n(this).val(),t,o,a;if(n("#"+f).hide(),h.length<i.numChars)return!1;for(u.css({"background-image":"url("+i.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"}),t=[],o="<Query><OrderBy><FieldRef Name='"+i.sourceColumn+"'/><\/OrderBy><Where>",i.CAMLQuery.length>0&&(o+="<And>"),o+="<"+i.filterType+"><FieldRef Name='"+i.sourceColumn+"'/><Value Type='Text'>"+h+"<\/Value><\/"+i.filterType+">",i.CAMLQuery.length>0&&(o+=i.CAMLQuery+"<\/And>"),o+="<\/Where><\/Query>",n().SPServices({operation:"GetListItems",async:!1,webURL:i.WebURL,listName:i.sourceList,CAMLQuery:o,CAMLQueryOptions:i.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+i.sourceColumn+"' /><\/ViewFields>",CAMLRowLimit:i.CAMLRowLimit,completefunc:function(r){var u=i.ignoreCase?h.toUpperCase():h;n(r.responseXML).SPFilterNode("z:row").each(function(){var r=n(this).attr("ows_"+i.sourceColumn),f=i.ignoreCase?n(this).attr("ows_"+i.sourceColumn).toUpperCase():n(this).attr("ows_"+i.sourceColumn),e;i.filterType==="Contains"?(e=f.indexOf(u),e>=0&&(!i.uniqueVals||n.inArray(r,t)===-1)&&t.push(n(this).attr("ows_"+i.sourceColumn))):u!==f.substr(0,u.length)||i.uniqueVals&&n.inArray(r,t)!==-1||t.push(n(this).attr("ows_"+i.sourceColumn))})}}),a="",r=0;r<t.length;r++){if(i.highlightClass.length>0){var w=RegExp(h,i.ignoreCase?"gi":"g"),l=t[r].match(w),y=0;for(e=0;e<l.length;e++){var v=t[r].indexOf(l[e],y),b=v+l[e].length,p="<span class='"+i.highlightClass+"'>"+l[e]+"<\/span>";t[r]=t[r].substr(0,v)+p+t[r].substr(b),y=v+p.length}}a+="<li style='display: block;position: relative;cursor: pointer;'>"+t[r]+"<\/li>"}n("#"+f).html(a),n("#"+f+" li").click(function(){n("#"+f).fadeOut(i.slideUpSpeed),n("#"+s).val(n(this).text()),n("#client-search-button").click()}).mouseover(function(){n(this).css({cursor:"hand",color:"#ffffff",background:"#3399ff"})}).mouseout(function(){var t={cursor:"inherit",color:c,background:"transparent"};n(this).css(t)}),t.length>0&&n("#"+f).slideDown(i.slideDownSpeed),u.css("background-image","")})},n.fn.SPServices.SPAutocompleteMod=function(t){var i=n.extend({},{WebURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><\/QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},t),e,u=n("input[Title='"+i.columnName+"']"),f;n("input[Title='"+i.columnName+"']").css("position","");var s=u.attr("ID"),c=u.css("color"),o=u.css("width");if(u.html()===null&&i.debug){h("SPServices.SPAutocomplete","columnName: "+i.columnName,"Column is not an input control or is not found on page");return}u.closest("span").find("br").remove(),u.wrap("<div>"),f=et("SPAutocomplete",i.columnName),u.after("<div><ul id='"+f+"' style='width:"+o+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'><\/div>"),n("#"+f).css("width",o),n(u).keyup(function(){var h=n(this).val(),t,o,a;if(n("#"+f).hide(),h.length<i.numChars)return!1;for(u.css({"background-image":"url("+i.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"}),t=[],o="<Query><OrderBy><FieldRef Name='"+i.sourceColumn+"'/><\/OrderBy><Where>",i.CAMLQuery.length>0&&(o+="<And>"),o+="<"+i.filterType+"><FieldRef Name='"+i.sourceColumn+"'/><Value Type='Text'>"+h+"<\/Value><\/"+i.filterType+">",i.CAMLQuery.length>0&&(o+=i.CAMLQuery+"<\/And>"),o+="<\/Where><\/Query>",n().SPServices({operation:"GetListItems",async:!1,webURL:i.WebURL,listName:i.sourceList,CAMLQuery:o,CAMLQueryOptions:i.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+i.sourceColumn+"' /><\/ViewFields>",CAMLRowLimit:i.CAMLRowLimit,completefunc:function(r){var u=i.ignoreCase?h.toUpperCase():h;n(r.responseXML).SPFilterNode("z:row").each(function(){var r=n(this).attr("ows_"+i.sourceColumn),f=i.ignoreCase?n(this).attr("ows_"+i.sourceColumn).toUpperCase():n(this).attr("ows_"+i.sourceColumn),e;i.filterType==="Contains"?(e=f.indexOf(u),e>=0&&(!i.uniqueVals||n.inArray(r,t)===-1)&&t.push(n(this).attr("ows_"+i.sourceColumn))):u!==f.substr(0,u.length)||i.uniqueVals&&n.inArray(r,t)!==-1||t.push(n(this).attr("ows_"+i.sourceColumn))})}}),a="",r=0;r<t.length;r++){if(i.highlightClass.length>0){var w=RegExp(h,i.ignoreCase?"gi":"g"),l=t[r].match(w),y=0;for(e=0;e<l.length;e++){var v=t[r].indexOf(l[e],y),b=v+l[e].length,p="<span class='"+i.highlightClass+"'>"+l[e]+"<\/span>";t[r]=t[r].substr(0,v)+p+t[r].substr(b),y=v+p.length}}a+="<li style='display: block;position: relative;cursor: pointer;'>"+t[r].replace("string;#",""),+ "</li>"}n("#"+f).html(a),n("#"+f+" li").click(function(){n("#"+f).fadeOut(i.slideUpSpeed),n("#"+s).val(n(this).text()),n("#client-search-button").click()}).mouseover(function(){n(this).css({cursor:"hand",color:"#ffffff",background:"#3399ff"})}).mouseout(function(){var t={cursor:"inherit",color:c,background:"transparent"};n(this).css(t)}),t.length>0&&n("#"+f).slideDown(i.slideDownSpeed),u.css("background-image","")})},n.fn.SPServices.SPGetQueryString=function(){for(var t={},u=location.search.substring(1,location.search.length),i=u.split("&"),r=/^([^=]+)=(.*)/i,n=0;n<i.length;n++)matches=r.exec(i[n]),r.test(location.href)&&matches!==null&&matches.length>2&&(t[matches[1]]=unescape(matches[2]).replace(/\+/g," "));return t},n.fn.SPServices.SPListNameFromUrl=function(t){var i=n.extend({},{listName:""},t);if(i.listName.length>0)return rt=i.listName;if(rt.length>0)return rt;var r=location.href,u=r.substring(0,r.indexOf(".aspx")),f=decodeURIComponent(u.substring(0,u.lastIndexOf(c)+1)).toUpperCase();return n().SPServices({operation:"GetListCollection",async:!1,completefunc:function(t){n(t.responseXML).find("List").each(function(){var t=n(this).attr("DefaultViewUrl"),i=t.substring(0,t.lastIndexOf(c)+1).toUpperCase();if(f.indexOf(i)>0)return rt=n(this).attr("ID"),!1})}}),rt},n.fn.SPServices.SPUpdateMultipleListItems=function(t){var i=n.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},t),u,e=[],o=[],f,r;for(n().SPServices({operation:"GetListItems",async:!1,webURL:i.webURL,listName:i.listName,CAMLQuery:i.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /><\/QueryOptions>",completefunc:function(t){n(t.responseXML).SPFilterNode("z:row").each(function(){e.push(n(this).attr("ows_ID"));var t=n(this).attr("ows_FileRef");t="/"+t.substring(t.indexOf(";#")+2),o.push(t)})}}),r="<Batch OnError='Continue'>",u=0;u<e.length;u++){for(r+="<Method ID='"+u+"' Cmd='"+i.batchCmd+"'>",f=0;f<i.valuepairs.length;f++)r+="<Field Name='"+i.valuepairs[f][0]+"'>"+ht(i.valuepairs[f][1])+"<\/Field>";r+="<Field Name='ID'>"+e[u]+"<\/Field>",o[u].length>0&&(r+="<Field Name='FileRef'>"+o[u]+"<\/Field>"),r+="<\/Method>"}r+="<\/Batch>",n().SPServices({operation:"UpdateListItems",async:!1,webURL:i.webURL,listName:i.listName,updates:r,completefunc:function(n,t){i.completefunc!==null&&i.completefunc(n,t)}})},n.fn.SPFilterNode=function(n){return this.find("*").filter(function(){return this.nodeName===n})},n.fn.SPXmlToJson=function(t){var i=n.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0},t),r=[];return this.each(function(){var u={},f=this.attributes;for(n.each(i.mapping,function(){u[this.mappedName]=""}),attrNum=0;attrNum<f.length;attrNum++){var e=f[attrNum].name,t=i.mapping[e],o=t!==undefined?t.mappedName:i.removeOws?e.split("ows_")[1]:e,s=t!==undefined?t.objectType:undefined;(i.includeAllAttrs||t!==undefined)&&(u[o]=si(f[attrNum].value,s))}r.push(u)}),r},n.fn.SPFindPeoplePicker=function(t){var i=n.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:!0},t),f=n("nobr").filter(function(){return n(this).contents().eq(0).text()===i.peoplePickerDisplayName}).closest("tr"),r=f.find("div[name='upLevelDiv']"),e=f.find("img[Title='Check Names']:first"),o,u;return i.valueToSet.length>0&&r.html(i.valueToSet),i.checkNames&&e.click(),o=n.trim(r.text()),u=[],r.children("span").each(function(){var i=n(this).find("div[data]").attr("data"),t={},r;i!=undefined?(r=n.parseXML(i),$xml=n(r),$xml.find("DictionaryEntry").each(function(){var i=n(this).find("Key").text(),r=n(this).find("Value").text();t[i]=r}),u.push(t)):n().SPServices({operation:"GetUserInfo",async:!1,cacheXML:!0,userLoginName:n(this).attr("title"),completefunc:function(i){n(i.responseXML).find("User").each(function(){n.each(this.attributes,function(n,i){var r=i.name,u=i.value;t[r]=u}),u.push(t)})}})}),{row:f,contents:r,currentValue:o,checkNames:e,dictionaryEntries:u}},n.fn.SPServices.Version=function(){return yi}})(jQuery);
//@ sourceMappingURL=mod.jquery.SPServices-0.7.2.min.js.map